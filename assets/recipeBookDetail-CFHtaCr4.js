import{Q as z}from"./QInnerLoading-86XDDgru.js";import{U as H,ay as M,V as j,X as U,W,I as _,N as X,L as Y,aD as Z,aA as G,aC as J,Y as K,Z as d,ag as $,a1 as f,a0 as l,$ as c,aj as k,a7 as N,ar as ee,a5 as te,as as w,av as oe}from"./index-CmuCMgBa.js";import{P as ae,Q as ie}from"./paginationPageSize-D7MNSaKA.js";import{Q as re}from"./QPage-Blsos2c0.js";import{F as le}from"./folder.service-3sR9fq5W.js";import{B as ne}from"./breadcrumb.service-B5JON7r2.js";import{V as se}from"./validation.service-Bh9qf873.js";import{f as de}from"./format-Dq9uPdyY.js";import{R as me}from"./recipe.service-B2BkU8jg.js";import{F as V}from"./QCardActions-CLJaF5Bu.js";import{s as ce,S as ue}from"./searchFilter-B46quSSD.js";import{E as fe}from"./editableText-Bw7tCjDH.js";import{F as pe}from"./favoriteIcon-D9PrWxBc.js";import{L as ve}from"./listItem-DaZeiiGx.js";import{R as ge}from"./recipeItemActions-DR6360ev.js";import"./QInput-Lm2QrpE2.js";import"./uid-Bzmka5Fh.js";import"./debounce-Dh_zIq8Y.js";import"./QSelect-B1fV5hfF.js";import"./use-prevent-scroll-5Ac-51KI.js";import"./History-BRlARYUr.js";import"./rtl-DFPa-2ov.js";import"./is-BddHB8T5.js";import"./QBtnDropdown-BGAbgpwa.js";import"./ClosePopup-Bnjv8jFB.js";import"./QCardSection-NG0FHRHY.js";import"./QCard-C4N2OtfF.js";import"./QCheckbox-WeQmrjpL.js";import"./QForm-BI170nwI.js";import"./searchAutocomplete-DxeGRu9i.js";import"./QImg-BWxTlY2N.js";import"./index-BkI8a_iM.js";const ye=H({__name:"recipeBookDetail",setup(p,{expose:n}){n();const{capitalize:v}=de,e=M(),{t:u}=j({useScope:"global"}),m=U(),i=W(),{getFolderById:s,editFolder:g,removeFolder:B}=le(),{editRecipe:y}=me(),{minLength:D,required:Q}=se(),{updateTitle:h}=ne(),{filter:R,search:S,page:x,pageSize:L,sortBy:O}=ce(V.RecipeBookDetails),F=_(!1),t=_(),I=_(0),A=[{title:"folder.delete",icon:J}],q={"favorite.add":async o=>{const a=await y(o.id,{favorite:!0});t.value&&(t.value.items=t.value?.items.map(r=>r.id===o.id?a:r))},"favorite.remove":async o=>{const a=await y(o.id,{favorite:!1});t.value&&(t.value.items=t.value?.items.map(r=>r.id===o.id?a:r))},"folder.delete":async o=>{e.dialog({title:v(u("delete")),message:u("recipeBook.deleteFrom",{item:o.name}),cancel:!0,persistent:!0}).onOk(async()=>{const a=t.value?.items.filter(r=>r.id!==o.id);t.value=await g(o.id,{items:a}),t.value&&!t.value?.items.length&&await B(t.value.id)})}},T=(o,a)=>q[o]?.(a);async function C(){F.value=!0;const o=m.params.id;if(!o||typeof o!="string"){await i.push({name:"NotFound"});return}await Z();const a=await s(o,{filter:R.value,search:S.value,page:x.value,pageSize:L.value,sortBy:O.value});if(!a){await i.push({name:"NotFound"});return}t.value=a,I.value=a.totalFiltered,h(1,t.value.name),F.value=!1}async function P(o,a){const r=await g(t.value.id,{...t.value,...o});if(!r){await i.push({name:"NotFound"});return}t.value=r,t.value?.name&&h(1,t.value.name),typeof a=="function"&&a()}const E={name:"RecipeBookCreate",query:{folderId:m.params.id}};X(()=>Y(()=>m.params.id,C,{immediate:!0}));const b={capitalize:v,$q:e,t:u,route:m,router:i,getFolderById:s,editFolder:g,removeFolder:B,editRecipe:y,minLength:D,required:Q,updateTitle:h,filter:R,search:S,page:x,pageSize:L,sortBy:O,isLoading:F,folder:t,totalFiltered:I,menuOptions:A,itemMenuOptionHandler:q,menuHandler:T,loadFolder:C,update:P,createNewFolder:E,get ionAddOutline(){return G},get FilterType(){return V},EditableText:fe,FavoriteIcon:pe,ListItem:ve,RecipeItemActions:ge,SearchFilter:ue,Pagination:ae};return Object.defineProperty(b,"__isScriptSetup",{enumerable:!1,value:!0}),b}}),he={class:"row q-col-gutter-x-md q-col-gutter-y-md"},Fe={class:"col-12 title-height"},_e={key:0,class:"row q-col-gutter-x-md q-col-gutter-y-md"},ke={key:0,class:"flex flex-center full-width"},we={class:"text-h5"};function Be(p,n,v,e,u,m){return d(),$(re,{class:"q-pa-md q-col-gutter-x-md q-col-gutter-y-md"},{default:f(()=>[l(z,{showing:e.isLoading},null,8,["showing"]),!e.isLoading&&e.folder?(d(),c(N,{key:0},[k("div",he,[k("div",Fe,[l(e.EditableText,{class:"text-h5",rules:[e.required,e.minLength(2)],modelValue:e.folder.name,"onUpdate:modelValue":n[1]||(n[1]=i=>e.folder.name=i),placeholder:p.$t("recipeBook.name"),onOnChange:n[2]||(n[2]=(i,s)=>e.update({name:i},s))},{favoriteButtons:f(()=>[l(e.FavoriteIcon,{favorite:e.folder?.favorite,onOnChange:n[0]||(n[0]=i=>e.update({favorite:i}))},null,8,["favorite"])]),_:1},8,["rules","modelValue","placeholder"])])]),l(e.SearchFilter,{onOnChange:e.loadFolder,"filter-key":e.FilterType.RecipeBookDetails},null,8,["filter-key"]),e.isLoading?w("",!0):(d(),c("div",_e,[(d(!0),c(N,null,ee(e.folder.items,(i,s)=>(d(),c("div",{class:"col col-xs-12 col-sm-6 col-md-6 col-lg-4 col-xl-3",key:s},[l(e.ListItem,{item:i,"menu-options":e.menuOptions,"on-click-router-name":"RecipeDetail",onOnChange:e.menuHandler},{moreActions:f(()=>[l(e.RecipeItemActions,{item:i},null,8,["item"])]),_:2},1032,["item"])]))),128)),l(e.Pagination,{"filter-key":e.FilterType.RecipeBook,"total-filtered":e.totalFiltered,onOnChange:e.loadFolder},null,8,["filter-key","total-filtered"]),e.folder?.items?.length?w("",!0):(d(),c("div",ke,[k("div",we,te(p.$t("emptyListMessage")),1)]))]))],64)):w("",!0),l(ie,{position:"bottom-right",offset:[18,18]},{default:f(()=>[l(oe,{fab:"",icon:e.ionAddOutline,color:"primary",to:e.createNewFolder,disable:e.isLoading},null,8,["icon","disable"])]),_:1})]),_:1})}const ot=K(ye,[["render",Be],["__file","recipeBookDetail.vue"]]);export{ot as default};
