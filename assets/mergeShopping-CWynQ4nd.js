import{Q as v}from"./QCardSection-NG0FHRHY.js";import{U as P,W as R,I as g,N as U,aE as z,aA as N,Y as k,Z as I,ag as V,a1 as o,aj as l,a0 as a,a5 as d,av as q,a4 as u,a6 as D,aF as j,aG as B,a2 as L,as as M}from"./index-CmuCMgBa.js";import{a as F,Q as G}from"./QCardActions-CLJaF5Bu.js";import{Q as w}from"./QCard-C4N2OtfF.js";import{Q as H,a as W}from"./QSelect-B1fV5hfF.js";import{Q as Y}from"./QInnerLoading-86XDDgru.js";import{Q as Z}from"./QPage-Blsos2c0.js";import{S as J}from"./shopping.service-CSEzRJCL.js";import{V as K}from"./validation.service-Bh9qf873.js";import{D as X,m as $}from"./ingredientCalculator.utils-CnrQgiY1.js";import{f as ee}from"./format-Dq9uPdyY.js";import{C as te}from"./confirmationOnLeave.service-BRmX8Fqq.js";import{E as oe}from"./editableText-Bw7tCjDH.js";import{E as ae}from"./editableItems-WOirbmNq.js";import{S as ie}from"./searchAutocomplete-DxeGRu9i.js";import"./QInput-Lm2QrpE2.js";import"./uid-Bzmka5Fh.js";import"./debounce-Dh_zIq8Y.js";import"./use-prevent-scroll-5Ac-51KI.js";import"./History-BRlARYUr.js";import"./rtl-DFPa-2ov.js";import"./is-BddHB8T5.js";import"./random.utils--ZVVX1T7.js";import"./ingredient.constant-DXTw5qQM.js";import"./QForm-BI170nwI.js";import"./QCheckbox-WeQmrjpL.js";import"./QExpansionItem-BRzWrkZm.js";import"./QSeparator-BZj1x5fP.js";const le=P({__name:"mergeShopping",setup(n,{expose:i}){i();const{capitalize:S}=ee,e=R(),{creteShopping:f,getShopping:h}=J(),{required:t,minLength:s}=K(),{onMountedConfirmationOnLeave:x,onUnmountedConfirmationOnLeave:b}=te(),p=g(!1),m=g({name:X,ingredients:[]}),_=g([]),y=g(null),Q=g(null);function A(){if(!_.value?.length)return;p.value=!0;const c=[{key:"id",type:"MultiString",data:_.value.map(r=>r.id)}];h({filter:c}).then(({items:r})=>{m.value.ingredients=$(r),m.value.name=r.map(E=>E.name).join(" & ").substring(0,100)}).finally(()=>{p.value=!1})}function O(c,r){m.value={...m.value,...c},r?.()}async function T(){p.value=!0,await Promise.all([y,Q].map(r=>r?.value?.submit()));const c=await f(m.value).finally(()=>{p.value=!1});await e.push({name:"ShoppingDetail",params:{id:c.id}})}U(()=>x("ShoppingDetail")),z(()=>b());const C={capitalize:S,router:e,creteShopping:f,getShopping:h,required:t,minLength:s,onMountedConfirmationOnLeave:x,onUnmountedConfirmationOnLeave:b,isLoading:p,shopping:m,selectedShopping:_,editableTextRef:y,editableItemsRef:Q,generateShoppingList:A,update:O,create:T,get ionAddOutline(){return N},EditableText:oe,EditableItems:ae,SearchAutocomplete:ie};return Object.defineProperty(C,"__isScriptSetup",{enumerable:!1,value:!0}),C}}),ne={class:"row q-col-gutter-x-md q-col-gutter-y-md"},se={class:"col"},re={class:"text-h5 text-capitalize"},de={class:"text-subtitle2"},me={class:"row q-col-gutter-x-md q-col-gutter-y-md"},pe={class:"col col-xs-12 col-sm-12 col-md-12 col-lg-12 col-xl-12 title-height"},ce={class:"row q-col-gutter-x-md q-col-gutter-y-md"},ge={class:"col col-xs-12 col-sm-12 col-md-5 col-lg-4 col-xl-4"},ue=["src"],fe={class:"col col-xs-12 col-sm-12 col-md-12 col-lg-6 col-xl-6"},he={class:"text-h6 text-capitalize"};function _e(n,i,S,e,f,h){return I(),V(Z,{class:"q-pa-md q-col-gutter-x-md q-col-gutter-y-md"},{default:o(()=>[l("div",ne,[l("div",se,[a(w,{class:"q-pa-sm"},{default:o(()=>[a(v,{horizontal:"",class:"justify-between"},{default:o(()=>[a(v,null,{default:o(()=>[l("div",re,d(n.$t("shopping.createTitle")),1),l("div",de,d(n.$t("shopping.mergeDescription")),1)]),_:1}),a(F,{class:"q-pa-none"},{default:o(()=>[a(q,{disable:!e.shopping.ingredients.length,onClick:i[0]||(i[0]=t=>e.create()),color:"primary"},{default:o(()=>[u(d(n.$t("create")),1)]),_:1},8,["disable"])]),_:1})]),_:1})]),_:1})])]),l("div",me,[l("div",pe,[a(e.EditableText,{class:"text-h5",modelValue:e.shopping.name,"onUpdate:modelValue":i[1]||(i[1]=t=>e.shopping.name=t),rules:[e.required,e.minLength(1)],"create-mode":!0,ref:"editableTextRef",placeholder:n.$t("shopping.createTitlePlaceholder"),onOnChange:i[2]||(i[2]=(t,s)=>e.update({name:t},s))},null,8,["modelValue","rules","placeholder"])])]),l("div",ce,[l("div",ge,[a(e.SearchAutocomplete,{label:n.$t("shopping.name",2),"get-list":(...t)=>e.getShopping(...t).then(({items:s})=>s),modelValue:e.selectedShopping,"onUpdate:modelValue":i[3]||(i[3]=t=>e.selectedShopping=t),multiple:"","max-values":3,hint:n.$t("shopping.maxItems",{item:3})},{"selected-item":o(t=>[a(H,{class:"ellipsis",removable:"",dense:"",color:"teal",onRemove:s=>t.removeAtIndex(t.index),tabindex:t.tabindex},{default:o(()=>[u(d(t.opt.name),1)]),_:2},1032,["onRemove","tabindex"])]),option:o(t=>[a(D,j(B(t.itemProps)),{default:o(()=>[a(L,{thumbnail:""},{default:o(()=>[l("img",{src:t.opt.imageUrl,loading:"lazy"},null,8,ue)]),_:2},1024),a(L,{style:{width:"168px"}},{default:o(()=>[a(W,{class:"ellipsis"},{default:o(()=>[u(d(t.opt.name),1)]),_:2},1024),a(G,{anchor:"top middle",offset:[14,30],delay:150},{default:o(()=>[u(d(e.capitalize(t.opt.name)),1)]),_:2},1024)]),_:2},1024)]),_:2},1040)]),_:1},8,["label","get-list","modelValue","hint"]),a(q,{style:{width:"300px"},color:"primary",class:"q-mt-sm",icon:e.ionAddOutline,onClick:e.generateShoppingList,loading:e.isLoading},{default:o(()=>[u(d(n.$t("shopping.merge")),1)]),_:1},8,["icon","loading"])]),l("div",fe,[a(Y,{showing:e.isLoading},null,8,["showing"]),e.shopping.ingredients.length?(I(),V(w,{key:0,id:"list"},{default:o(()=>[a(v,null,{default:o(()=>[l("div",he,d(n.$t("shopping.name")),1)]),_:1}),a(e.EditableItems,{modelValue:e.shopping.ingredients,"onUpdate:modelValue":i[4]||(i[4]=t=>e.shopping.ingredients=t),"create-mode":!0,ref:"editableItemsRef",onOnChange:i[5]||(i[5]=(t,s)=>e.update({ingredients:t},s))},null,8,["modelValue"])]),_:1})):M("",!0)])])]),_:1})}const He=k(le,[["render",_e],["__scopeId","data-v-7b5b3722"],["__file","mergeShopping.vue"]]);export{He as default};
