import{n as u,d}from"./index-CmuCMgBa.js";const a=()=>!0;function l(t){return typeof t=="string"&&t!==""&&t!=="/"&&t!=="#/"}function f(t){return t.startsWith("#")===!0&&(t=t.substring(1)),t.startsWith("/")===!1&&(t="/"+t),t.endsWith("/")===!0&&(t=t.substring(0,t.length-1)),"#"+t}function h(t){if(t.backButtonExit===!1)return()=>!1;if(t.backButtonExit==="*")return a;const n=["#/"];return Array.isArray(t.backButtonExit)===!0&&n.push(...t.backButtonExit.filter(l).map(f)),()=>n.includes(window.location.hash)}const b={__history:[],add:u,remove:u,install({$q:t}){if(this.__installed===!0)return;const{cordova:n,capacitor:e}=d.is;if(n!==!0&&e!==!0)return;const o=t.config[n===!0?"cordova":"capacitor"];if(o!==void 0&&o.backButton===!1||e===!0&&(window.Capacitor===void 0||window.Capacitor.Plugins.App===void 0))return;this.add=i=>{i.condition===void 0&&(i.condition=a),this.__history.push(i)},this.remove=i=>{const s=this.__history.indexOf(i);s>=0&&this.__history.splice(s,1)};const c=h(Object.assign({backButtonExit:!0},o)),r=()=>{if(this.__history.length){const i=this.__history[this.__history.length-1];i.condition()===!0&&(this.__history.pop(),i.handler())}else c()===!0?navigator.app.exitApp():window.history.back()};n===!0?document.addEventListener("deviceready",()=>{document.addEventListener("backbutton",r,!1)}):window.Capacitor.Plugins.App.addListener("backButton",r)}};export{b as H};
